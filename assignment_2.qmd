---
title: "assignment_2"
format: html
editor: visual
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo       = TRUE, 
                      fig.height = 3, 
                      fig.width  = 6,
                      fig.align  = "center")
ggplot2::theme_set(ggplot2::theme_bw())
```

```{r}
#| message: false
library(tidyverse)

library(lubridate)
```

# Question 1:

Write a function `pos_na()` that takes two vectors of equal length and returns the positions where **both** vectors contain `NA`.\
If the vectors do **not** have the same length, the function should return the message:

> `"The vectors are not the same length."`

Use the following pairs of vectors to test your function:

1.  `c(1, NA, 2)` and `c(NA, NA)`
2.  `c(NA, NA, 2)` and `c(NA, NA, 2)`
3.  `c(NA, 5, NA)` and `c(NA, NA, NA)`
4.  `c(NA, NA, NA, 2, NA, 4, NA)` and `c(NA, NA, 2, 4, 4, NA, NA)`
5.  `c(1, NA, NA, 2, NA, 4, NA)` and `c(NA, -5, 2, 4, 4, NA, 11)`

Here’s a polished, professional way to label those two parts of the assignment. It reads cleanly and sets expectations without adding extra wording.

------------------------------------------------------------------------

### (1i) Using an `if` statement

Write a version of `pos_na()` that checks whether the two input vectors have the same length using an `if` statement.

-   If they do, return the positions where both vectors contain `NA`.

-   If they do not, return the message:

> `"The vectors are not the same length."`

```{r}
pos_na <- function(v1, v2) {
  if(length(v1) != length(v2)) {
    return("The vectors are not the same length.")
  } else {
    na <- which(is.na(v1) & is.na(v2))
    return(na)
  }
}

one <- c(1, NA, 2)
two <- c(NA, NA)
pos_na(one, two)


a <- c(NA, NA, 2)
b <- c(NA, NA, 2)
pos_na(a, b)


add <- c(NA, 5, NA)
sub <- c(NA, NA, NA)
pos_na(add, sub)


app <- c(NA, NA, NA, 2, NA, 4, NA)
ban <- c(NA, NA, 2, 4, 4, NA, NA)
pos_na(app, ban)


r <- c(1, NA, NA, 2, NA, 4, NA)
w <- c(NA, -5, 2, 4, 4, NA, 11)
pos_na(r, w)

```

### (1ii) Without using an `if` statement

Write a second version of `pos_na()` that performs the same task **without** using an `if` statement.

-   You may use any other valid R mechanism (e.g., `stop()`, `stopifnot()`, or logical short‑circuiting) to handle the case where the vectors differ in length.

```{r}
pos_na2 <- function(v1, v2) {
  outputs <- list(which(is.na(v1) & is.na(v2)),
                  "The vectors are not the same length.")
  
  logicvariable <- 2 - (length(v1) == length(v2))
  
  return(outputs[[logicvariable]])
}

one <- c(1, NA, 2)
two <- c(NA, NA)
pos_na2(one, two)


a <- c(NA, NA, 2)
b <- c(NA, NA, 2)
pos_na2(a, b)


add <- c(NA, 5, NA)
sub <- c(NA, NA, NA)
pos_na2(add, sub)


app <- c(NA, NA, NA, 2, NA, 4, NA)
ban <- c(NA, NA, 2, 4, 4, NA, NA)
pos_na2(app, ban)


r <- c(1, NA, NA, 2, NA, 4, NA)
w <- c(NA, -5, 2, 4, 4, NA, 11)
pos_na2(r, w)
```

\`\`

# Question 2

Load the `wmata_ridership` data frame into R from <https://dcgerard.github.io/stat_412_612/data/wmata_ridership.csv>. For each month, calculate the proportion of rides made on a given day of the month. Then make box plots of the proportion

```{r}
wmata <- read.csv("wmata_ridership.csv")
wmata
str(wmata)

wmata <- wmata %>%
  mutate(prop = Total/sum(Total))

wmata

jan <- wmata[substr(wmata$Date, 6, 7) == "01", ]

feb <- wmata[substr(wmata$Date, 6, 7) == "02", ]

mar <- wmata[substr(wmata$Date, 6, 7) == "03", ]

apr <- wmata[substr(wmata$Date, 6, 7) == "04", ]

may <- wmata[substr(wmata$Date, 6, 7) == "05", ]

jun <- wmata[substr(wmata$Date, 6, 7) == "06", ]

jul <- wmata[substr(wmata$Date, 6, 7) == "07", ]

aug <- wmata[substr(wmata$Date, 6, 7) == "08", ]

sep <- wmata[substr(wmata$Date, 6, 7) == "09", ]

oct <- wmata[substr(wmata$Date, 6, 7) == "10", ]

nov <- wmata[substr(wmata$Date, 6, 7) == "11", ]

dec <- wmata[substr(wmata$Date, 6, 7) == "12", ]

ggplot(data = jan, mapping = aes(x = prop)) +
  geom_boxplot(col = "orchid", fill = "white") +
  labs(x = "Proportion of daily rides", 
       title = "Boxplot of January WMATA ridership") +
  theme_bw()

ggplot(data = feb, mapping = aes(x = prop)) +
  geom_boxplot(col = "blue", fill = "white") +
  labs(x = "Proportion of daily rides", 
       title = "Boxplot of February WMATA ridership") +
  theme_bw()

ggplot(data = mar, mapping = aes(x = prop)) +
  geom_boxplot(col = "darkgreen", fill = "white") +
  labs(x = "Proportion of daily rides", 
       title = "Boxplot of March WMATA ridership") +
  theme_bw()

ggplot(data = apr, mapping = aes(x = prop)) +
  geom_boxplot(col = "red", fill = "white") +
  labs(x = "Proportion of daily rides", 
       title = "Boxplot of April WMATA ridership") +
  theme_bw()

ggplot(data = may, mapping = aes(x = prop)) +
  geom_boxplot(col = "brown", fill = "white") +
  labs(x = "Proportion of daily rides", 
       title = "Boxplot of May WMATA ridership") +
  theme_bw()

ggplot(data = jun, mapping = aes(x = prop)) +
  geom_boxplot(col = "black", fill = "white") +
  labs(x = "Proportion of daily rides", 
       title = "Boxplot of June WMATA ridership") +
  theme_bw()

ggplot(data = jul, mapping = aes(x = prop)) +
  geom_boxplot(col = "darkorange", fill = "white") +
  labs(x = "Proportion of daily rides", 
       title = "Boxplot of July WMATA ridership") +
  theme_bw()

ggplot(data = aug, mapping = aes(x = prop)) +
  geom_boxplot(col = "darkred", fill = "white") +
  labs(x = "Proportion of daily rides", 
       title = "Boxplot of August WMATA ridership") +
  theme_bw()

ggplot(data = sep, mapping = aes(x = prop)) +
  geom_boxplot(col = "deeppink", fill = "white") +
  labs(x = "Proportion of daily rides", 
       title = "Boxplot of September WMATA ridership") +
  theme_bw()

ggplot(data = oct, mapping = aes(x = prop)) +
  geom_boxplot(col = "darkblue", fill = "white") +
  labs(x = "Proportion of daily rides", 
       title = "Boxplot of October WMATA ridership") +
  theme_bw()

ggplot(data = nov, mapping = aes(x = prop)) +
  geom_boxplot(col = "purple", fill = "white") +
  labs(x = "Proportion of daily rides", 
       title = "Boxplot of November WMATA ridership") +
  theme_bw()

ggplot(data = dec, mapping = aes(x = prop)) +
  geom_boxplot(col = "coral", fill = "white") +
  labs(x = "Proportion of daily rides", 
       title = "Boxplot of December WMATA ridership") +
  theme_bw()
```

# Question 3:

Write R code that extracts the elements "Bears", "Dolphins", and "Bengals" from the vector `V` shown below, and display the result.

```{r}
V <- c("Bears", "Lions", "Dolphins", "Eagles", "Bengals")
```

## (3i) Subsetting by index

## (3ii) Subsetting using a `for` loop

## (3iii)Returning all values in a single vector (one line of code)

### (a) Using positive indices

### (b) Using negative indices

### (c) Using logical indexing

### (d) Attempting to subset by names

# Question 4:

You are given a character vector containing messy employee records. Each entry includes:

-   an employee name (string),
-   a hire date in inconsistent formats,
-   and a department code that should be treated as a factor.

```{r}
records <- c(
  "Steve McQueen | 2020-01-15 | HR",
  "B. Smith | 15/02/2021 | FIN",
  "Carlos M | March 3, 2019 | IT",
  "D. Lee | 2018/07/30 | HR",
  "Alain Delon | 04-12-2020 | MKT"
)
records
```

1.  **Parse each record** into three separate variables:

    -   `name`\
    -   `hire_date`\
    -   `dept`

2.  **Convert `hire_date` into a proper `Date` object**, correctly handling all of the different date formats.

3.  **Convert `dept` into an ordered factor** with the levels:\
    `HR`, `FIN`, `IT`, `MKT`.

4.  **Construct a clean data frame** containing the parsed and converted variables.

5.  **Add a new variable** called `years_worked` that reports the number of full years each employee has worked as of today.

6.  **Return the final cleaned data frame.**
